# GMS-AI-Matching

> **ðŸ“‹ Google Form**: [Submit your mentor/mentee application here](https://forms.gle/6spWTWthQi9G3vDaA)

A sophisticated mentor-mentee matching system that uses a combination of rule-based and semantic scoring to create optimal pairings based on preferences, compatibility, and goals.

## Overview

This project matches **university mentors** with **high school mentees** using multiple scoring criteria including:
- **Gender, ethnicity, and LGBTQ+ preferences** - Respects individual matching preferences
- **MBTI personality compatibility** - Uses research-based compatibility matrix
- **Semantic similarity of goals and interests** - NLP-powered understanding of aspirations
- **Availability overlap** - Finds matching time slots across the week

**Important**: The system only creates mentor â†’ mentee matches. Mentors must be from universities, mentees from high schools.

## Features

- **Multiple Matching Algorithms**: Greedy assignment and Gale-Shapley stable matching
- **Capacity Management**: Respects mentor capacity constraints
- **Semantic Scoring**: Uses sentence transformers for goals and interests similarity
- **Google Sheets Integration**: Direct import from Google Forms responses
- **Detailed Analytics**: Comprehensive breakdown of matching criteria
- **Flexible Preferences**: Soft or hard enforcement of gender/ethnicity preferences

## Quick Start

### Installation

1. Clone the repository
```bash
git clone https://github.com/yashc73080/GMS-AI-Matching.git
```

2. Navigate to the project directory:
```bash
cd GMS-AI-Matching
```

3. Install dependencies:
```bash
pip install -r requirements.txt
```

### Configuration

#### Setting Up Google Sheets Integration

1. **Create a Google Cloud Project**:
   - Go to [Google Cloud Console](https://console.cloud.google.com/)
   - Create a new project or select an existing one

2. **Enable Google Sheets API**:
   - Navigate to "APIs & Services" â†’ "Library"
   - Search for "Google Sheets API" and enable it
   - Also enable "Google Drive API"

3. **Create Service Account**:
   - Go to "APIs & Services" â†’ "Credentials"
   - Click "Create Credentials" â†’ "Service Account"
   - Fill in service account details and click "Create"
   - Skip optional steps and click "Done"

4. **Generate Service Account Key**:
   - Click on the service account you just created
   - Go to "Keys" tab
   - Click "Add Key" â†’ "Create new key"
   - Choose "JSON" format and download the file
   - Rename it to something like `grey-matter-society-credentials.json`
   - Place it in your project root directory

5. **Get Your Google Sheet ID**:
   - Open your Google Sheet (with form responses)
   - The Sheet ID is in the URL: `https://docs.google.com/spreadsheets/d/{SHEET_ID}/edit`
   - Copy the long string between `/d/` and `/edit`

6. **Share Your Sheet with the Service Account**:
   - Open the downloaded JSON file
   - Find the `"client_email"` field (looks like `example@project-name.iam.gserviceaccount.com`)
   - Open your Google Sheet
   - Click "Share" and paste the client email
   - Grant "Viewer" or "Editor" access

7. **Create `.env` File**:
   Create a file named `.env` in your project root with:
   ```env
   SHEET_ID='your_sheet_id_here'
   GCRED_PATH='grey-matter-society-credentials.json'
   ```

### Running the Matcher

```bash
python big_little.py
```

## Input Data

The system expects data with the following columns (matching the schema in [`schema.md`](schema.md)):

### Required for All
- `Timestamp` - Auto-generated by Google Forms
- `Full Name` - Participant's full name
- `Email (School or University Email)` - Must be .edu for mentors (recommended)
- `Gender` - Male, Female, Other, Prefer not to say
- `Are you part of the LGBTQ+ community?` - Yes, No, Prefer not to say
- `Ethnicity` - White, Black, Asian, Hispanic, Two or more races, Other, Prefer not to say
- `State` - US state abbreviation (e.g., NJ, CA, IL)
- `Do you want to be a Mentor or Mentee?` - **Mentor or Mentee**
- `MBTI` - 16 personality types (e.g., INTJ, ENFP)
- `Interests/Hobbies` - Free text, comma-separated
- `Goals` - Free text describing aspirations

### Preference Fields
- `Would you like to be matched with someone of similar ethnic demographics?` - Yes, No, No Preference
- `Would you like to be matched with someone of similar gender?` - Yes, No, No Preference
- `Would you like to be matched with someone from the LGBTQ+ community?` - Yes, No, No Preference

### Availability Fields (All 7 days)
- `Availability [Monday]` through `Availability [Sunday]`
- Options: Morning, Afternoon, Evening, Night (multi-select)

### Mentor-Specific Fields
- `University` - Full university name (e.g., "Rutgers University")
- `Class Year` - Graduation year (e.g., 2025, 2026)
- `How many mentees do you want?` - Integer (1, 2, 3, etc.)

### Mentee-Specific Fields
- `High School` - Full high school name (e.g., "Piscataway High School")

**Important Validation Rules:**
- Mentors MUST have `University` filled (NOT `High School`)
- Mentees MUST have `High School` filled (NOT `University`)
- The system will validate and warn about any mismatches

### Data Sources

- **CSV File**: Use [`sample_mentors_mentees.csv`](sample_mentors_mentees.csv)
- **Google Sheets**: Configure `SHEET_ID` and `GCRED_PATH` in your `.env`

## Configuration Options

Edit the configuration section in [`big_little.py`](big_little.py):

```python
INPUT_CSV = 'sample_mentors_mentees.csv'  # Or None for Google Sheets
SEMANTIC = 'embed'    # 'off' or 'embed' for semantic scoring
PREFS = 'soft'        # 'soft' or 'hard' preference enforcement
MATCH_ALGO = 'stable' # 'greedy' or 'stable' matching algorithm
```

## Scoring System

The matching score is calculated using weighted criteria:

| Criterion | Default Weight | Description |
|-----------|----------------|-------------|
| Goals (Semantic) | 30 | Semantic similarity of goals using NLP |
| Interests (Semantic) | 25 | Semantic similarity of interests using NLP |
| Gender Preference | 20 | Mentee's preference for similar gender matches mentor |
| Ethnicity Preference | 20 | Mentee's preference for similar ethnicity matches mentor |
| LGBTQ+ Preference | 20 | LGBTQ+ community preference matching |
| Availability Overlap | 20 | Matching time slots across the week |
| MBTI Compatibility | 20 | Based on compatibility matrix |

**Note:** Mentor preferences (gender, ethnicity, LGBTQ+) are weighted at 50% of mentee preferences to prioritize mentee needs while still considering mentor preferences.

**Ignored Factors:** Location (state), class year proximity, and school names are not considered in the matching algorithm.

### MBTI Compatibility

Uses a predefined compatibility matrix in [`big_little.py`](big_little.py) that scores personality type compatibility from 0-15.

## Output Files

### `/out` Directory
- `mentor_mentee_full_scores.csv` - All mentor-mentee pair scores
- `mentor_mentee_topK_per_mentee.csv` - Top K matches per mentee
- `mentor_mentee_assigned_pairs_{algorithm}.csv` - Final assignments

### `/results` Directory
- [`mentor_mentee_assignments.csv`](results/mentor_mentee_assignments.csv) - Clean assignment list
- [`mentor_mentee_detailed.csv`](results/mentor_mentee_detailed.csv) - Detailed match breakdown

## Matching Algorithms

### Greedy Assignment
- [`greedy_assign_with_capacity`](matching_algos.py) - Assigns highest scoring pairs first
- Respects mentor capacity constraints
- Fast but may not be globally optimal

### Stable Matching (Gale-Shapley)
- [`gale_shapley_with_capacity`](matching_algos.py) - Ensures stable matches
- No mentor-mentee pair would prefer each other over current matches
- More computationally intensive but produces stable results

## Key Components

### Core Files
- [`big_little.py`](big_little.py) - Main script with scoring logic
- [`matching_algos.py`](matching_algos.py) - Matching algorithms
- [`semantic_scorer.py`](semantic_scorer.py) - Semantic similarity scoring
- [`sheet_helper.py`](sheet_helper.py) - Google Sheets integration and normalization

### Configuration
- [`requirements.txt`](requirements.txt) - Python dependencies
- [`.env`](.env) - Environment variables

## Semantic Scoring

When `SEMANTIC = 'embed'`, the system uses:
- **Model**: `all-MiniLM-L6-v2` (configurable)
- **Method**: Cosine similarity of sentence embeddings
- **Scope**: Goals and Interests/Hobbies comparison

To disable semantic scoring, set `SEMANTIC = 'off'` in [`big_little.py`](big_little.py).

## Understanding Results

The detailed output includes breakdown fields (`BRK::`) showing points awarded for each criterion. See [`brk_fields.md`](brk_fields.md) for detailed explanations.

## Google Forms Integration

Google Form Link: https://forms.gle/6spWTWthQi9G3vDaA

The system can directly import responses from Google Forms via Google Sheets API. Requires:
1. Service account JSON file
2. Sheet ID in environment variables
3. Proper API permissions

## Development

### Adding New Scoring Criteria
1. Update [`compute_score`](big_little.py) function
2. Add to `DEFAULT_WEIGHTS` dictionary
3. Include in breakdown (`brk`) dictionary

### Supporting New Input Fields
1. Update [`normalize_responses`](sheet_helper.py) for data cleaning
2. Add to expected columns list in [`big_little.py`](big_little.py)

## Dependencies

- `pandas` - Data manipulation
- `sentence-transformers` - Semantic similarity (optional)
- `scikit-learn` - Cosine similarity computation
- `gspread` - Google Sheets integration
- `numpy` - Numerical operations